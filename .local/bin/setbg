#!/bin/sh

# this script is based on https://github.com/bugswriter 's
# sets the bg on ~/pix/wall randomly,
# it integrates xwallpaper and pywal

# TODO: shit?

echo "[setbg] Choosing a random wallpaper..."
wallpaper=$(find $HOME/pictures -type f | shuf -n 1)

echo "[setbg] Wallpaper found..."
xwallpaper --zoom $wallpaper

echo "[setbg] Generating pywal color schemes..."
wal -i $wallpaper -n >/dev/null
sed -i 'N;$!P;D' $HOME/.cache/wal/colors-wal-dwm.h

echo "[setbg] Recompiling dwm with new colors..."
(cd $HOME/.config/suckless/dwm && sudo make clean install>/dev/null)

echo "[setbg] Recompiling dmenu with new colors..."
(cd $HOME/.config/suckless/dmenu && sudo make clean install>/dev/null)

echo "[setbg] Successfully recompiled! restart dwm to get changes"
